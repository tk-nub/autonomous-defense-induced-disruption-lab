# ğŸŒ Routing Playwright Traffic Through Tor (Kali Linux)

This project supports routing Playwright browser automation through the Tor network to simulate distributed external traffic and vary source IP telemetry during testing.

All browser traffic is routed through Torâ€™s local SOCKS proxy.

Tested on **Kali Linux Rolling**.

---

## ğŸ“¦ Prerequisites

- Kali Linux
- Node.js â‰¥ 18
- npm
- Internet connectivity
- sudo privileges

---

## âš™ï¸ 1. Install Dependencies

### Update system
```bash
sudo apt update && sudo apt upgrade -y
```

### Install Node.js and npm
```bash
sudo apt install nodejs npm -y
```

Verify:
```bash
node -v
npm -v
```

---

## ğŸ­ 2. Install Playwright

Inside your project directory:

```bash
npm init -y
npm install playwright
npx playwright install
```

---

## ğŸ§… 3. Install and Start Tor

```bash
sudo apt install tor -y
sudo systemctl enable tor
sudo systemctl start tor
```

Verify:
```bash
sudo systemctl status tor
```

Tor SOCKS proxy:
```
127.0.0.1:9050
```

Confirm listener:
```bash
ss -lntp | grep 9050
```

---

## ğŸ” 4. Verify Tor Connectivity

Normal IP:
```bash
curl https://api.ipify.org
```

Tor IP:
```bash
curl --socks5 127.0.0.1:9050 https://api.ipify.org
```

IPs should differ.

Optional:
```bash
curl --socks5 127.0.0.1:9050 https://check.torproject.org
```

---

## ğŸ§ª 5. Configure Playwright to Use Tor

Create a test script:

```javascript
const { chromium } = require("playwright");

(async () => {

  const browser = await chromium.launch({
    proxy: {
      server: "socks5h://127.0.0.1:9050"
    },
    headless: false
  });

  const page = await browser.newPage();

  await page.goto("https://check.torproject.org", {
    waitUntil: "networkidle",
    timeout: 120000
  });

})();
```

Run:
```bash
node test.js
```

If configured correctly, the page will confirm Tor usage.

---

## ğŸ” Prevent DNS Leaks (Recommended)

Use:

```
socks5h://127.0.0.1:9050
```

The `h` ensures hostname resolution occurs through Tor.

---

## ğŸ”„ Rotate Tor Exit Node (Optional)

```bash
sudo kill -HUP $(pgrep tor)
```

---

## ğŸ§° Alternative: proxychains (System-Wide Routing)

Install:
```bash
sudo apt install proxychains4
```

Edit config:
```bash
sudo nano /etc/proxychains4.conf
```

Ensure:
```
dynamic_chain
socks5 127.0.0.1 9050
```

Run:
```bash
proxychains4 node test.js
```

Native Playwright proxy configuration is recommended.

---

## âš ï¸ Known Limitations

- Some sites block Tor exit nodes
- Higher latency
- Tor â‰  Tor Browser fingerprint
- Automation may still be detectable

---

## ğŸ§ª Use Case

- simulate distributed user traffic
- vary source IP telemetry
- test detection systems
- generate external browsing activity in lab environments

---

## ğŸ›  Troubleshooting

Restart Tor:
```bash
sudo systemctl restart tor
```

Manual proxy test:
```bash
curl --socks5 127.0.0.1:9050 https://google.com
```

---

## ğŸ“„ License / Usage Notice

For research and controlled lab environments only.  
Do not deploy in production without authorization.
